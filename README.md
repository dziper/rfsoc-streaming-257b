# rfsoc-streaming-257b
UCSD ECE 257B Project - Streaming from RFSoc

This repo contains an implementation of our Sliding Window ACK/NACK based Streaming protocol, currently implemented for one way streaming between two PCs.
The implementation has abstractions allowing it to be extended in the future to stream between an RFSoC (ZCU111 FPGA) and a PC and zmq+srsRAN.


- [rfsoc-streaming-257b](#rfsoc-streaming-257b)
  - [Running the Code](#running-the-code)
    - [Setup](#setup)
    - [Benchmarking](#benchmarking)
    - [Generate Random File](#generate-random-file)
  - [File Overview](#file-overview)
    - [`x86-64/src`](#x86-64src)
      - [Streaming Protocol Implementation](#streaming-protocol-implementation)
      - [Abstractions and Implementations](#abstractions-and-implementations)
      - [Basic TCP Implementation](#basic-tcp-implementation)
    - [`Vitis HLS codes`](#vitis-hls-codes)
    - [`docs`](#docs)
    - [`x86-64/initial`](#x86-64initial)
    - [`benchmark`](#benchmark)


## Running the Code

### Setup
Requirements
- Tested for MacOS or Ubuntu
- C++11

To build the 

### Benchmarking

### Generate Random File
```sh
head -c 1000000 </dev/urandom >myfile
```


## File Overview

If you're here, you're most likely looking for the [Streaming Protocol Implementation](#streaming-protocol-implementation) or the [benchmarking scripts](#benchmark)

### `x86-64/src`

#### Streaming Protocol Implementation
- `MainStreamer.cpp`
  - Top level Stream Sender program for running tests
- `MainReceiver.cpp`
  - Top level Stream Receiver program for running tests
- `StreamSender.hpp, StreamSender_impl.hpp`
  - Contains implementation for the Streaming Protocol logic on the sender side, as well as the `StreamSender` interface.
  - The `StreamSender` is templated to abstract a `DataProvider` and `NetworkConnection`
- `StreamReceiver.hpp, StreamReceiver_impl.hpp`
  - Contains implementation for the Streaming Protocol logic on the receiver side, as well as the `StreamReceiver` interface.
  - The `StreamReceiver` is templated to abstract a `DataProcessor` and `NetworkConnection`

#### Abstractions and Implementations
- `DataProcessing.hpp`
  - Contains the `DataProvider` abstraction for abstracting getting data to stream
    - `FileData.hpp : FileReader` reads data from a file
    - `DummyData.hpp : DummyProvider` creates dummy data for testing
    - `FPGADataProvider.hpp : FPGADataProvider` stub for future implementation of reading RF data on FPGA
  - Contains the `DataProcessor` abstraction for abstracting what to do with received data
    - `FileData.hpp : FileWriter` writes received data to a file
    - `DummyData.hpp : DummyProcessor` prints received data or does nothing
    - `ZmqDataProcessor.hpp : ZmqDataProcessor` publishes received data to a ZeroMQ socket, for future connection to srsRAN
- `NetworkConnection.hpp`
  - Contains the `NetworkConnection` abstraction for abstracting sending/receiving data over the network
    - `UDPNetworkConnection.hpp`
      - `UDPStreamSender / UDPStreamReceiver` create simple udp sockets to send packets
      - `FaultyUDPStreamReceiver` acts as a `UDPStreamReceiver`, except has some probability to flip a bit in the received packet, simulating low channel quality or congestion on the channel.
    - `FPGANetworkConnection.hpp : FPGANetworkConnection` stub for future implementation of sending data to Ethernet Subsystem on RFSoC

#### Basic TCP Implementation
- `MainBasicSender.cpp / BasicSender.hpp` implement simple TCP streaming using the `DataProvider` and `NetworkConnection` abstractions
- `MainBasicReceiver.cpp / BasicReceiver.hpp` implement simple TCP streaming using the `DataProcessor` and `NetworkConnection` abstractions

### `Vitis HLS codes`
- Contains HLS implementation for FPGA of basic data packetization to send to Ethernet Subsystem
- Currently not integrated with Streaming Protocol

### `docs`
- `ICD.md` Contains Interface Control Document for Streaming Protocol
  - TODO: Rendered in `ICD.pdf`
- Meeting notes

### `x86-64/initial`
- `StreamReceiver.cpp/StreamSender.cpp` Contains initial implementation of the streaming protocol

### `benchmark`
- `benchmark.py` Contains script for running streaming benchmark with multiple window sizes and different simulated probability of error
  - Reports result in a `csv`
- `plot.py` Plot data from `csv` generated by `benchmark.py`

